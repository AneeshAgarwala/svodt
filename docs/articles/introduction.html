<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Constructing Oblique Trees with svmodt • svmodt</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Constructing Oblique Trees with svmodt">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">svmodt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction.html">Constructing Oblique Trees with svmodt</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><script src="introduction_files/kePrint-0.0.1/kePrint.js"></script><link href="introduction_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Constructing Oblique Trees with svmodt</h1>
            
      

      <div class="hidden name"><code>introduction.Rmd</code></div>

    </div>

    
    
<p>This vignette demonstrates how to:</p>
<ol style="list-style-type: decimal">
<li>Train SVMODT models on binary classification data</li>
<li>Make predictions and evaluate performance</li>
<li>Visualize decision boundaries</li>
</ol>
<p>We’ll use two datasets:</p>
<ul>
<li>
<strong>Palmer Penguins</strong>: Ecological data for species
classification</li>
<li>
<strong>Wisconsin Breast Cancer</strong>: Medical diagnosis
data</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Packages required for this vignette</span></span>
<span><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"rpart"</span>, <span class="st">"e1071"</span>, <span class="st">"dplyr"</span>, <span class="st">"tidyr"</span>,</span>
<span>  <span class="st">"rsample"</span>, <span class="st">"gridExtra"</span>, <span class="st">"kableExtra"</span>, <span class="st">"palmerpenguins"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load each package quietly if available</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">pkgs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pkg</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="va">pkg</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Package '%s' is required to run this vignette."</span>, <span class="va">pkg</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">svmodt</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="example-1-palmer-penguins-classification">Example 1: Palmer Penguins Classification<a class="anchor" aria-label="anchor" href="#example-1-palmer-penguins-classification"></a>
</h2>
<p>The Palmer Penguins dataset contains measurements of three penguin
species from Antarctica. We’ll build a classifier to distinguish between
<strong>Adelie</strong> and <strong>Chinstrap</strong> penguins.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Adelie vs Chinstrap</span></span>
<span><span class="va">penguins_data</span> <span class="op">&lt;-</span> <span class="fu">palmerpenguins</span><span class="fu">::</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/reference/penguins.html" class="external-link">penguins</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">species</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Adelie"</span>, <span class="st">"Chinstrap"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">bill_length_mm</span>, <span class="va">bill_depth_mm</span>, </span>
<span>         <span class="va">flipper_length_mm</span>, <span class="va">body_mass_g</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">234</span><span class="op">)</span></span>
<span></span>
<span><span class="va">split_data</span> <span class="op">&lt;-</span> <span class="fu">rsample</span><span class="fu">::</span><span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html" class="external-link">initial_split</a></span><span class="op">(</span><span class="va">penguins_data</span>, prop <span class="op">=</span> <span class="fl">0.8</span>, strata <span class="op">=</span> <span class="va">species</span><span class="op">)</span></span>
<span></span>
<span><span class="va">train_penguins</span> <span class="op">&lt;-</span> <span class="fu">rsample</span><span class="fu">::</span><span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html" class="external-link">training</a></span><span class="op">(</span><span class="va">split_data</span><span class="op">)</span></span>
<span><span class="va">test_penguins</span> <span class="op">&lt;-</span> <span class="fu">rsample</span><span class="fu">::</span><span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html" class="external-link">testing</a></span><span class="op">(</span><span class="va">split_data</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="train-svmodt-model">Train SVMODT Model<a class="anchor" aria-label="anchor" href="#train-svmodt-model"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Train basic SVMODT</span></span>
<span><span class="va">tree_penguins</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/svm_split.html">svm_split</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">train_penguins</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>  max_depth <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  max_features <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  feature_method <span class="op">=</span> <span class="st">"mutual"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="examine-tree-structure">Examine Tree Structure<a class="anchor" aria-label="anchor" href="#examine-tree-structure"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print tree structure</span></span>
<span><span class="fu"><a href="../reference/print_svm_tree.html">print_svm_tree</a></span><span class="op">(</span><span class="va">tree_penguins</span>, </span>
<span>               show_probabilities <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>               show_feature_info <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [Node] depth = 1 | n = 174 | features = [bill_length_mm,flipper_length_mm] | max_feat = 2 | penalty = +</span></span>
<span><span class="co">#&gt;  |- Left branch (SVM &gt; 0):</span></span>
<span><span class="co">#&gt; |   [Node] depth = 2 | n = 121 | features = [bill_length_mm,bill_depth_mm]</span></span>
<span><span class="co">#&gt; |   |- Left branch (SVM &gt; 0):</span></span>
<span><span class="co">#&gt; |  |   [Leaf] predict = Adelie | n = 120 | probs = [Adelie = 0.975, Chinstrap = 0.025] | features = [bill_length_mm,bill_depth_mm]</span></span>
<span><span class="co">#&gt; |   `- Right branch (SVM &lt;= 0):</span></span>
<span><span class="co">#&gt; |      (no right child)</span></span>
<span><span class="co">#&gt;  `- Right branch (SVM &lt;= 0):</span></span>
<span><span class="co">#&gt;     [Node] depth = 2 | n = 53 | features = [bill_length_mm,bill_depth_mm]</span></span>
<span><span class="co">#&gt;     |- Left branch (SVM &gt; 0):</span></span>
<span><span class="co">#&gt;     |  (no left child)</span></span>
<span><span class="co">#&gt;     `- Right branch (SVM &lt;= 0):</span></span>
<span><span class="co">#&gt;        [Leaf] predict = Chinstrap | n = 51 | probs = [Adelie = 0.02, Chinstrap = 0.98] | features = [bill_length_mm,bill_depth_mm]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="make-predictions">Make Predictions<a class="anchor" aria-label="anchor" href="#make-predictions"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Predict classes only</span></span>
<span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/svm_predict_tree.html">svm_predict_tree</a></span><span class="op">(</span><span class="va">tree_penguins</span>, <span class="va">test_penguins</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predict with probabilities</span></span>
<span><span class="va">predictions_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/svm_predict_tree.html">svm_predict_tree</a></span><span class="op">(</span><span class="va">tree_penguins</span>, <span class="va">test_penguins</span>, </span>
<span>                                     return_probs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View first few predictions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Actual <span class="op">=</span> <span class="va">test_penguins</span><span class="op">$</span><span class="va">species</span>,</span>
<span>  Predicted <span class="op">=</span> <span class="va">predictions_prob</span><span class="op">$</span><span class="va">predictions</span>,</span>
<span>  Prob_Adelie <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">predictions_prob</span><span class="op">$</span><span class="va">probabilities</span><span class="op">[</span>, <span class="st">"Adelie"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  Prob_Chinstrap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">predictions_prob</span><span class="op">$</span><span class="va">probabilities</span><span class="op">[</span>, <span class="st">"Chinstrap"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"lccc"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Actual</th>
<th align="center">Predicted</th>
<th align="center">Prob_Adelie</th>
<th align="center">Prob_Chinstrap</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Adelie</td>
<td align="center">Adelie</td>
<td align="center">0.975</td>
<td align="center">0.025</td>
</tr>
<tr class="even">
<td align="left">Adelie</td>
<td align="center">Adelie</td>
<td align="center">0.975</td>
<td align="center">0.025</td>
</tr>
<tr class="odd">
<td align="left">Adelie</td>
<td align="center">Adelie</td>
<td align="center">0.975</td>
<td align="center">0.025</td>
</tr>
<tr class="even">
<td align="left">Adelie</td>
<td align="center">Adelie</td>
<td align="center">0.975</td>
<td align="center">0.025</td>
</tr>
<tr class="odd">
<td align="left">Adelie</td>
<td align="center">Adelie</td>
<td align="center">0.975</td>
<td align="center">0.025</td>
</tr>
<tr class="even">
<td align="left">Adelie</td>
<td align="center">Adelie</td>
<td align="center">0.975</td>
<td align="center">0.025</td>
</tr>
<tr class="odd">
<td align="left">Adelie</td>
<td align="center">Adelie</td>
<td align="center">0.975</td>
<td align="center">0.025</td>
</tr>
<tr class="even">
<td align="left">Adelie</td>
<td align="center">Adelie</td>
<td align="center">0.975</td>
<td align="center">0.025</td>
</tr>
<tr class="odd">
<td align="left">Adelie</td>
<td align="center">Adelie</td>
<td align="center">0.975</td>
<td align="center">0.025</td>
</tr>
<tr class="even">
<td align="left">Adelie</td>
<td align="center">Adelie</td>
<td align="center">0.975</td>
<td align="center">0.025</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="evaluate-performance">Evaluate Performance<a class="anchor" aria-label="anchor" href="#evaluate-performance"></a>
</h3>
</div>
<div class="section level3">
<h3 id="visualize-decision-boundaries">Visualize Decision Boundaries<a class="anchor" aria-label="anchor" href="#visualize-decision-boundaries"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualize tree decision boundaries</span></span>
<span><span class="va">viz_penguins</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visualize_svm_tree.html">visualize_svm_tree</a></span><span class="op">(</span></span>
<span>  tree <span class="op">=</span> <span class="va">tree_penguins</span>,</span>
<span>  original_data <span class="op">=</span> <span class="va">train_penguins</span>,</span>
<span>  response_col <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>  max_depth <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">viz_penguins</span><span class="op">$</span><span class="va">plots</span><span class="op">$</span><span class="va">depth_1_Root</span></span></code></pre></div>
<div class="figure">
<img src="introduction_files/figure-html/penguins-viz-1.png" alt="SVMODT Split at Root Node (Depth = 1)" width="768"><p class="caption">
SVMODT Split at Root Node (Depth = 1)
</p>
</div>
<p>Fig @ref(fig:penguins-viz) depicts the root node of the SVM-based
oblique decision tree, where the first split is performed using the
features bill_length_mm and flipper_length_mm. The figure illustrates
how the linear SVM at the root node divides the dataset into two
branches, guiding samples toward subsequent child nodes.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">viz_penguins</span><span class="op">$</span><span class="va">plots</span><span class="op">$</span><span class="va">`depth_2_Root_→_L`</span>, <span class="va">viz_penguins</span><span class="op">$</span><span class="va">plots</span><span class="op">$</span><span class="va">`depth_2_Root_→_R`</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="introduction_files/figure-html/penguins-viz-2-1.png" alt="SVMODT Split at Child Node (Depth = 2)" width="768"><p class="caption">
SVMODT Split at Child Node (Depth = 2)
</p>
</div>
<p>Fig @ref(fig:penguins-viz-2) shows a node at depth 2 of the tree,
where the SVM uses bill_length_mm and bill_depth_mm to further partition
the data. The decision hyper-plane and sample positions are plotted,
highlighting how oblique splits can capture multivariate relationships
that univariate thresholds cannot.</p>
</div>
<div class="section level3">
<h3 id="trace-prediction-path">Trace Prediction Path<a class="anchor" aria-label="anchor" href="#trace-prediction-path"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trace_prediction_path.html">trace_prediction_path</a></span><span class="op">(</span><span class="va">tree_penguins</span>, <span class="va">test_penguins</span>, sample_idx <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; === Tracing Prediction Path ===</span></span>
<span><span class="co">#&gt; Sample 1 :</span></span>
<span><span class="co">#&gt;    species = 1 </span></span>
<span><span class="co">#&gt;    bill_length_mm = 38.9 </span></span>
<span><span class="co">#&gt;    bill_depth_mm = 17.8 </span></span>
<span><span class="co">#&gt;    flipper_length_mm = 181 </span></span>
<span><span class="co">#&gt;    body_mass_g = 3625 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  [Node 1 ] features = bill_length_mm,flipper_length_mm </span></span>
<span><span class="co">#&gt;    SVM decision value: 2.0018 </span></span>
<span><span class="co">#&gt;    -&gt; Going LEFT (decision &gt; 0)</span></span>
<span><span class="co">#&gt;    [Node 2 ] features = bill_length_mm,bill_depth_mm </span></span>
<span><span class="co">#&gt;      SVM decision value: 2.5287 </span></span>
<span><span class="co">#&gt;      -&gt; Going LEFT (decision &gt; 0)</span></span>
<span><span class="co">#&gt;      [FINAL] Predict Adelie (n = 120 )</span></span>
<span><span class="co">#&gt;      Path taken: LEFT -&gt; LEFT </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Final prediction: Adelie</span></span>
<span><span class="co">#&gt; [1] "Adelie"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="example-2-wisconsin-breast-cancer-diagnosis">Example 2: Wisconsin Breast Cancer Diagnosis<a class="anchor" aria-label="anchor" href="#example-2-wisconsin-breast-cancer-diagnosis"></a>
</h2>
<div class="section level3">
<h3 id="about-the-data">About the Data<a class="anchor" aria-label="anchor" href="#about-the-data"></a>
</h3>
<p>The Wisconsin Breast Cancer dataset contains features computed from
digitized images of fine needle aspirate (FNA) of breast masses. The
task is to classify tumors as <strong>Benign (B)</strong> or
<strong>Malignant (M)</strong>.</p>
</div>
<div class="section level3">
<h3 id="load-and-prepare-data">Load and Prepare Data<a class="anchor" aria-label="anchor" href="#load-and-prepare-data"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">234</span><span class="op">)</span></span>
<span></span>
<span><span class="va">split_data</span> <span class="op">&lt;-</span> <span class="fu">rsample</span><span class="fu">::</span><span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html" class="external-link">initial_split</a></span><span class="op">(</span><span class="va">wdbc</span>, prop <span class="op">=</span> <span class="fl">0.8</span>, strata <span class="op">=</span> <span class="va">diagnosis</span><span class="op">)</span></span>
<span></span>
<span><span class="va">train_wdbc</span> <span class="op">&lt;-</span> <span class="fu">rsample</span><span class="fu">::</span><span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html" class="external-link">training</a></span><span class="op">(</span><span class="va">split_data</span><span class="op">)</span></span>
<span><span class="va">test_wdbc</span> <span class="op">&lt;-</span> <span class="fu">rsample</span><span class="fu">::</span><span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html" class="external-link">testing</a></span><span class="op">(</span><span class="va">split_data</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="train-with-class-weights">Train with Class Weights<a class="anchor" aria-label="anchor" href="#train-with-class-weights"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_wdbc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/svm_split.html">svm_split</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">train_wdbc</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"diagnosis"</span>,</span>
<span>  max_depth <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  min_samples <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  max_features <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  feature_method <span class="op">=</span> <span class="st">"mutual"</span>,</span>
<span>  class_weights <span class="op">=</span> <span class="st">"balanced"</span>,  <span class="co"># For Class Imbalance</span></span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="advanced-features">Advanced Features<a class="anchor" aria-label="anchor" href="#advanced-features"></a>
</h3>
<div class="section level4">
<h4 id="feature-selection-with-penalties">Feature Selection with Penalties<a class="anchor" aria-label="anchor" href="#feature-selection-with-penalties"></a>
</h4>
<p>svmodt promotes feature diversity by penalizing previously used
features in ancestor nodes.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Train with feature penalty</span></span>
<span><span class="va">tree_penalty</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/svm_split.html">svm_split</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">train_penguins</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>  max_depth <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  max_features <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  feature_method <span class="op">=</span> <span class="st">"cor"</span>,</span>
<span>  penalize_used_features <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  feature_penalty_weight <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="dynamic-feature-selection">Dynamic Feature Selection<a class="anchor" aria-label="anchor" href="#dynamic-feature-selection"></a>
</h3>
<p>The package also allows user to either randomize or decrease the
number of features in child nodes.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Decrease features with depth</span></span>
<span><span class="va">tree_decrease</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/svm_split.html">svm_split</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">train_wdbc</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"diagnosis"</span>,</span>
<span>  max_depth <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  max_features <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  max_features_strategy <span class="op">=</span> <span class="st">"decrease"</span>,</span>
<span>  max_features_decrease_rate <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Random feature selection</span></span>
<span><span class="va">tree_random</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/svm_split.html">svm_split</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">train_wdbc</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"diagnosis"</span>,</span>
<span>  max_depth <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  max_features_strategy <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>  max_features_random_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="custom-class-weights">Custom Class Weights<a class="anchor" aria-label="anchor" href="#custom-class-weights"></a>
</h3>
<p>We can also add custom class weights for our class labels in the
model using domain expertise. This enables us to minimise classification
of false negatives by assigning correct weights based on domain
expertise.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Give malignant cases higher weight</span></span>
<span><span class="va">custom_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"M"</span> <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tree_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/svm_split.html">svm_split</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">train_wdbc</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"diagnosis"</span>,</span>
<span>  max_depth <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  max_features <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  class_weights <span class="op">=</span> <span class="st">"custom"</span>,</span>
<span>  custom_class_weights <span class="op">=</span> <span class="va">custom_weights</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="model-comparison">Model Comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h2>
<p>Now, we will compare the performance of our SVMODT model with other
classification models such as a Linear SVM and a Decision Tree. For our
svmodt tree we are using a tree-depth of 2 with mutual feature selection
and penalization. For the decision tree we are setting the
cost-complexity parameter as 0.01. Lastly, for the linear SVM model we
have not done any hyperparameter tuning and using the default parameter
of C = 1.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># RPART decision tree</span></span>
<span><span class="va">tree_rpart</span> <span class="op">&lt;-</span> <span class="fu">rpart</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html" class="external-link">rpart</a></span><span class="op">(</span><span class="va">diagnosis</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train_wdbc</span>,</span>
<span>                   control <span class="op">=</span> <span class="fu">rpart</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.control.html" class="external-link">rpart.control</a></span><span class="op">(</span>cp <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pred_rpart</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">tree_rpart</span>, <span class="va">test_wdbc</span>, type <span class="op">=</span> <span class="st">"class"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tree_wdbc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/svm_split.html">svm_split</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">train_wdbc</span>,</span>
<span>                               response <span class="op">=</span> <span class="st">"diagnosis"</span>, </span>
<span>                               max_depth <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                               feature_method <span class="op">=</span> <span class="st">"mutual"</span>, </span>
<span>                               penalize_used_features <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Standard SVM</span></span>
<span><span class="va">model_svm</span> <span class="op">&lt;-</span> <span class="fu">e1071</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/svm.html" class="external-link">svm</a></span><span class="op">(</span><span class="va">diagnosis</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train_wdbc</span>, probability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">pred_svm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model_svm</span>, <span class="va">test_wdbc</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get SVMODT predictions</span></span>
<span><span class="va">pred_svmodt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/svm_predict_tree.html">svm_predict_tree</a></span><span class="op">(</span><span class="va">tree_wdbc</span>, <span class="va">test_wdbc</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare accuracies</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SVMODT"</span>, <span class="st">"RPART"</span>, <span class="st">"Linear SVM"</span><span class="op">)</span>,</span>
<span>  Accuracy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pred_svmodt</span> <span class="op">==</span> <span class="va">test_wdbc</span><span class="op">$</span><span class="va">diagnosis</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pred_rpart</span> <span class="op">==</span> <span class="va">test_wdbc</span><span class="op">$</span><span class="va">diagnosis</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pred_svm</span> <span class="op">==</span> <span class="va">test_wdbc</span><span class="op">$</span><span class="va">diagnosis</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">results</span> <span class="op">|&gt;</span> <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"lc"</span>, format <span class="op">=</span> <span class="st">"html"</span>, digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                             caption <span class="op">=</span> <span class="st">"Comparing Test set Accuracy of SVMODT model with a Linear SVM and a Decision Tree"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"center"</span>, full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Comparing Test set Accuracy of SVMODT model with a Linear SVM and a
Decision Tree
</caption>
<thead><tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:center;">
Accuracy
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
SVMODT
</td>
<td style="text-align:center;">
0.9652
</td>
</tr>
<tr>
<td style="text-align:left;">
RPART
</td>
<td style="text-align:center;">
0.8870
</td>
</tr>
<tr>
<td style="text-align:left;">
Linear SVM
</td>
<td style="text-align:center;">
0.9565
</td>
</tr>
</tbody>
</table>
<p>From Table @ref(tab:comparison) we can observe that our SVMODT model
has outperformed both the Linear SVM model and the Rpart Decision tree
on the test.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Aneesh Agarwal, Jack Jewson, Erik Sverdrup.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
